$schema: https://azuremlschemas.azureedge.net/latest/commandJob.schema.json
inputs:
  title: 'My Single Job RAI'
  task_type: 'classification' # [classification, regression]
  model_id: common_fetch_model_adult_1645799670:3
  train_dataset:
    dataset: azureml:Adult_Train_PQ:1645799500
    mode: ro_mount
  test_dataset:
    dataset: azureml:Adult_Test_PQ:1645799500
    mode: ro_mount
  target_column_name: income
  maximum_rows_for_test_dataset: 5000
  categorical_column_names: '[]' # Optional[List[str]]
  classes: '[]'  # Optional[List[str]]
  # ------
  enable_explanation: True
  # ------
outputs:
  dashboard:
    mode: upload
  ux_json:
    mode: upload
code:
  local_path: src
compute: azureml:cpucluster
environment: azureml:AML-RAI-Environment:1645799500
display_name: Single RAI Job
experiment_name: RAI_Single_Job_01
description: Run RAI in a single job
command: |
  set -o xtrace
  # =======================================
  # Get the code
  apt-get update
  apt-get install git --yes
  echo
  cd /tmp
  git clone https://github.com/Azure/RAI-vNext-Preview.git
  cd RAI-vNext-Preview
  git checkout riedgar-ms/single-rai-job
  echo
  cd single-rai-job
  # ========================================
  # Run the script
  python ./src/run_rai.py 
    --title '${{inputs.title}}'
    --task_type ${{inputs.task_type}}
    --model_id ${{inputs.model_id}}
    --train_dataset ${{inputs.train_dataset}}
    --test_dataset ${{inputs.test_dataset}}
    --target_column_name ${{inputs.target_column_name}}
    --maximum_rows_for_test_dataset ${{inputs.maximum_rows_for_test_dataset}}
    --categorical_column_names '${{inputs.categorical_column_names}}'
    --classes '${{inputs.classes}}'
    --enable_explanation ${{inputs.enable_explanation}}